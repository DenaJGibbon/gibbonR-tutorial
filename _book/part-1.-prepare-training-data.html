<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>2 Part 1. Prepare Training Data | gibbonR: An R package for the automated detection and classification of female gibbon calls from long-term acoustic recordings</title>
<meta name="author" content="Dena J. Clink">
<meta name="generator" content="bookdown 0.26 with bs4_book()">
<meta property="og:title" content="2 Part 1. Prepare Training Data | gibbonR: An R package for the automated detection and classification of female gibbon calls from long-term acoustic recordings">
<meta property="og:type" content="book">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="2 Part 1. Prepare Training Data | gibbonR: An R package for the automated detection and classification of female gibbon calls from long-term acoustic recordings">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<meta name="description" content="In ‘gibbonR’ there are two ways that you can format your training data. The first can be a set of labelled .wav clips with the class indicated in the name of the file (e.g., ‘gibbon_01.wav’ and...">
<meta property="og:description" content="In ‘gibbonR’ there are two ways that you can format your training data. The first can be a set of labelled .wav clips with the class indicated in the name of the file (e.g., ‘gibbon_01.wav’ and...">
<meta name="twitter:description" content="In ‘gibbonR’ there are two ways that you can format your training data. The first can be a set of labelled .wav clips with the class indicated in the name of the file (e.g., ‘gibbon_01.wav’ and...">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">gibbonR: An R package for the automated detection and classification of female gibbon calls from long-term acoustic recordings</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"><span class="header-section-number">1</span> Getting started</a></li>
<li><a class="active" href="part-1.-prepare-training-data.html"><span class="header-section-number">2</span> Part 1. Prepare Training Data</a></li>
<li><a class="" href="part-2.-run-the-detectorclassifier.html"><span class="header-section-number">3</span> Part 2. Run the detector/classifier</a></li>
<li><a class="" href="part-3.-calculate-performance-metrics.html"><span class="header-section-number">4</span> Part 3. Calculate performance metrics</a></li>
<li><a class="" href="part-4.-data-visualization.html"><span class="header-section-number">5</span> Part 4. Data visualization</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="part-1.-prepare-training-data" class="section level1" number="2">
<h1>
<span class="header-section-number">2</span> Part 1. Prepare Training Data<a class="anchor" aria-label="anchor" href="#part-1.-prepare-training-data"><i class="fas fa-link"></i></a>
</h1>
<p>In ‘gibbonR’ there are two ways that you can format your training data. The first can be a set of labelled .wav clips with the class indicated in the name of the file (e.g., ‘gibbon_01.wav’ and ‘noise_01.wav’). The second is to have a folder of selection tables created in Raven Pro (K. Lisa Yang Center for Conservation Bioacoustics) and a folder with the associated ‘.wav’ files. For the second approach there must be an annotation column indicating the call type and it is assumed that all signals of interest are annotated, and the rest of the files contain only background noise.</p>
<div id="part-1a.-training-data-with-labeled-.wav-clips" class="section level2" number="2.1">
<h2>
<span class="header-section-number">2.1</span> Part 1A. Training Data with Labeled .wav clips<a class="anchor" aria-label="anchor" href="#part-1a.-training-data-with-labeled-.wav-clips"><i class="fas fa-link"></i></a>
</h2>
<div id="read-in-clips-and-calculate-mfccs" class="section level3" number="2.1.1">
<h3>
<span class="header-section-number">2.1.1</span> Read in clips and calculate MFCCs<a class="anchor" aria-label="anchor" href="#read-in-clips-and-calculate-mfccs"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">TrainingWavFilesDir</span> <span class="op">&lt;-</span> 
  <span class="st">"/Users/denaclink/Desktop/RStudio Projects/gibbonR/data/MultipleSoundClasses/"</span>

<span class="va">trainingdata</span> <span class="op">&lt;-</span> <span class="fu">gibbonR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gibbonR/man/MFCCFunction.html">MFCCFunction</a></span><span class="op">(</span>input.dir<span class="op">=</span><span class="va">TrainingWavFilesDir</span>, min.freq <span class="op">=</span> <span class="fl">400</span>, max.freq <span class="op">=</span> <span class="fl">1600</span>,win.avg<span class="op">=</span><span class="st">"TRUE"</span><span class="op">)</span>


<span class="va">trainingdata</span><span class="op">$</span><span class="va">class</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">trainingdata</span><span class="op">$</span><span class="va">class</span><span class="op">)</span></code></pre></div>
</div>
<div id="compare-random-forest-and-support-vector-machine-for-supervised-classification" class="section level3" number="2.1.2">
<h3>
<span class="header-section-number">2.1.2</span> Compare Random Forest and Support Vector Machine for Supervised Classification<a class="anchor" aria-label="anchor" href="#compare-random-forest-and-support-vector-machine-for-supervised-classification"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">trainingdata</span><span class="op">$</span><span class="va">class</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">trainingdata</span><span class="op">$</span><span class="va">class</span><span class="op">)</span>


<span class="va">ml.model.svm</span> <span class="op">&lt;-</span> <span class="fu">e1071</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/e1071/man/svm.html">svm</a></span><span class="op">(</span><span class="va">trainingdata</span><span class="op">[</span>, <span class="fl">2</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">trainingdata</span><span class="op">)</span><span class="op">]</span>, <span class="va">trainingdata</span><span class="op">$</span><span class="va">class</span>, kernel <span class="op">=</span> <span class="st">"radial"</span>, 
                           cross <span class="op">=</span> <span class="fl">25</span>,
                           probability <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">'SVM accuracy'</span>,<span class="va">ml.model.svm</span><span class="op">$</span><span class="va">tot.accuracy</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] "SVM accuracy 88"</span>


<span class="va">ml.model.rf</span> <span class="op">&lt;-</span> <span class="fu">randomForest</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/randomForest/man/randomForest.html">randomForest</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">trainingdata</span><span class="op">[</span>, <span class="fl">2</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">trainingdata</span><span class="op">)</span><span class="op">]</span>, y <span class="op">=</span> <span class="va">trainingdata</span><span class="op">$</span><span class="va">class</span><span class="op">)</span>


<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">ml.model.rf</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt;  randomForest(x = trainingdata[, 2:ncol(trainingdata)], y = trainingdata$class) </span>
<span class="co">#&gt;                Type of random forest: classification</span>
<span class="co">#&gt;                      Number of trees: 500</span>
<span class="co">#&gt; No. of variables tried at each split: 13</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;         OOB estimate of  error rate: 13.33%</span>
<span class="co">#&gt; Confusion matrix:</span>
<span class="co">#&gt;               female.gibbon leaf.monkey noise solo.gibbon class.error</span>
<span class="co">#&gt; female.gibbon            17           0     2           1   0.1500000</span>
<span class="co">#&gt; leaf.monkey               0          11     4           0   0.2666667</span>
<span class="co">#&gt; noise                     0           0    18           2   0.1000000</span>
<span class="co">#&gt; solo.gibbon               0           1     0          19   0.0500000</span></code></pre></div>
</div>
</div>
<div id="part-1b.-training-data-with-raven-selection-tables" class="section level2" number="2.2">
<h2>
<span class="header-section-number">2.2</span> Part 1B. Training Data with Raven Selection Tables<a class="anchor" aria-label="anchor" href="#part-1b.-training-data-with-raven-selection-tables"><i class="fas fa-link"></i></a>
</h2>
<div id="prepare-training-data-from-labeled-annotations" class="section level3" number="2.2.1">
<h3>
<span class="header-section-number">2.2.1</span> Prepare training data from labeled annotations<a class="anchor" aria-label="anchor" href="#prepare-training-data-from-labeled-annotations"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Specify the folder where the training data will be saved</span>
<span class="va">TrainingDataFolderLocation</span> <span class="op">&lt;-</span> <span class="st">"/Users/denaclink/Desktop/RStudio Projects/gibbonR/data/TrainingDataFromRavenSelectionTables"</span>

<span class="co"># Directory with annotated selection tables</span>
<span class="va">AnnotatedSelectionTables</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span><span class="op">(</span><span class="st">"/Users/denaclink/Desktop/RStudio Projects/gibbonR/data/SelectionTables/GibbonTrainingSelectionTables/"</span>,
                                       full.names <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>

<span class="co"># Directory with corresponding .wav files</span>
<span class="va">AnnotatedWaveFiles</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span><span class="op">(</span><span class="st">"/Users/denaclink/Library/CloudStorage/Box-Box/gibbonRSampleFiles/GibbonTrainingFiles/"</span>,full.names <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>
<span class="va">AnnotatedWaveFilesShort</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span><span class="op">(</span><span class="st">"/Users/denaclink/Library/CloudStorage/Box-Box/gibbonRSampleFiles/GibbonTrainingFiles/"</span>,full.names <span class="op">=</span> <span class="cn">F</span><span class="op">)</span>
<span class="va">AnnotatedWaveFilesShort</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_split.html">str_split_fixed</a></span><span class="op">(</span><span class="va">AnnotatedWaveFilesShort</span>,pattern <span class="op">=</span> <span class="st">'.wav'</span>, n<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>

<span class="co"># Loop to cut out the corresponding annotations into short clips</span>
<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">AnnotatedSelectionTables</span><span class="op">)</span><span class="op">)</span><span class="op">{</span>
  
  <span class="co"># Read in selection table</span>
  <span class="va">TempSelectionTable</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.delim2</a></span><span class="op">(</span><span class="va">AnnotatedSelectionTables</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span>
  
  <span class="co"># Find the corresponding soundfile</span>
  <span class="va">SoundFileIndex</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">AnnotatedSelectionTables</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,<span class="va">AnnotatedWaveFilesShort</span><span class="op">)</span><span class="op">)</span>
  
  <span class="va">TempAnnotateWave</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/tuneR/man/readWave.html">readWave</a></span><span class="op">(</span><span class="va">AnnotatedWaveFiles</span><span class="op">[</span><span class="va">SoundFileIndex</span><span class="op">]</span><span class="op">)</span>
  
  <span class="va">ShortSoundClips</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">TempSelectionTable</span><span class="op">)</span>,
                                <span class="kw">function</span><span class="op">(</span><span class="va">j</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/pkg/tuneR/man/extractWave.html">extractWave</a></span><span class="op">(</span><span class="va">TempAnnotateWave</span>,
                                                        from<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">TempSelectionTable</span><span class="op">[</span><span class="va">j</span>,<span class="op">]</span><span class="op">$</span><span class="va">Begin.Time..s.</span><span class="op">)</span>,
                                                        to<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">TempSelectionTable</span><span class="op">[</span><span class="va">j</span>,<span class="op">]</span><span class="op">$</span> <span class="va">End.Time..s.</span><span class="op">)</span>,
                                                        xunit <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"time"</span><span class="op">)</span>,plot<span class="op">=</span><span class="cn">F</span>,output<span class="op">=</span><span class="st">"Wave"</span><span class="op">)</span><span class="op">)</span>
  <span class="co"># Write wave files to folder</span>
  <span class="kw">for</span><span class="op">(</span><span class="va">k</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">ShortSoundClips</span><span class="op">)</span><span class="op">)</span><span class="op">{</span>
    <span class="va">TempClip</span> <span class="op">&lt;-</span> <span class="va">ShortSoundClips</span><span class="op">[[</span><span class="va">k</span><span class="op">]</span><span class="op">]</span>
    <span class="va">WavFileName</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">TrainingDataFolderLocation</span>,<span class="st">'/female.gibbon_'</span>, <span class="va">k</span>, <span class="st">'.wav'</span>,sep<span class="op">=</span><span class="st">""</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/pkg/tuneR/man/writeWave.html">writeWave</a></span><span class="op">(</span><span class="va">TempClip</span>,<span class="va">WavFileName</span>,extensible <span class="op">=</span> <span class="cn">F</span><span class="op">)</span>
  <span class="op">}</span>
  
  
<span class="op">}</span></code></pre></div>
</div>
<div id="prepare-noise-training-data-from-files-without-target-signal" class="section level3" number="2.2.2">
<h3>
<span class="header-section-number">2.2.2</span> Prepare noise training data from files without target signal<a class="anchor" aria-label="anchor" href="#prepare-noise-training-data-from-files-without-target-signal"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Specify the folder where the training data will be saved</span>
<span class="va">TrainingDataFolderLocation</span> <span class="op">&lt;-</span> <span class="st">"/Users/denaclink/Desktop/RStudio Projects/gibbonR/data/TrainingDataFromRavenSelectionTables/"</span>

<span class="co"># Directory with annotated selection tables</span>
<span class="va">NoiseSelectionTables</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span><span class="op">(</span><span class="st">"/Users/denaclink/Desktop/RStudio Projects/gibbonR/data/SelectionTables/NoiseSelectionTables/"</span>,
                                       full.names <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>

<span class="co"># Directory with corresponding .wav files</span>
<span class="va">NoiseWaveFiles</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span><span class="op">(</span><span class="st">"/Users/denaclink/Library/CloudStorage/Box-Box/gibbonRSampleFiles/NoiseFiles/"</span>,full.names <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>
<span class="va">NoiseWaveFilesShort</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span><span class="op">(</span><span class="st">"/Users/denaclink/Library/CloudStorage/Box-Box/gibbonRSampleFiles/NoiseFiles/"</span>,full.names <span class="op">=</span> <span class="cn">F</span><span class="op">)</span>
<span class="va">NoiseWaveFilesShort</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_split.html">str_split_fixed</a></span><span class="op">(</span><span class="va">NoiseWaveFilesShort</span>,pattern <span class="op">=</span> <span class="st">'.wav'</span>, n<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>

<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">NoiseSelectionTables</span><span class="op">)</span><span class="op">)</span><span class="op">{</span>
  
  <span class="co"># Find the corresponding soundfile</span>
  <span class="va">SoundFileIndex</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">NoiseSelectionTables</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,<span class="va">NoiseWaveFilesShort</span><span class="op">)</span><span class="op">)</span>

  <span class="fu"><a href="https://rdrr.io/pkg/gibbonR/man/DetectBLED.html">DetectBLED</a></span><span class="op">(</span>input<span class="op">=</span><span class="va">NoiseWaveFiles</span><span class="op">[</span><span class="va">SoundFileIndex</span><span class="op">]</span>,
           min.freq <span class="op">=</span> <span class="fl">400</span>, 
           max.freq <span class="op">=</span> <span class="fl">1600</span>,
           noise.quantile.val<span class="op">=</span><span class="fl">0.3</span>,
           file.type<span class="op">=</span><span class="st">'wav'</span>,
           spectrogram.window <span class="op">=</span><span class="fl">512</span>,
           pattern.split <span class="op">=</span> <span class="st">".wav"</span>, 
           min.signal.dur <span class="op">=</span> <span class="fl">3</span>,
           max.sound.event.dur <span class="op">=</span> <span class="fl">12</span>, 
           output <span class="op">=</span> <span class="st">"wav"</span>,
           wav.output <span class="op">=</span> <span class="st">"TRUE"</span>, 
           output.dir <span class="op">=</span> <span class="va">TrainingDataFolderLocation</span>,
           swift.time<span class="op">=</span><span class="cn">TRUE</span>,
           time.start<span class="op">=</span><span class="fl">06</span>,
           time.stop<span class="op">=</span><span class="fl">11</span>,
           write.csv.output<span class="op">=</span><span class="cn">TRUE</span>,
           verbose<span class="op">=</span><span class="cn">TRUE</span>,
           random.sample<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
</div>
<div id="now-read-in-clips-based-on-raven-selection-tables-and-calculate-mfccs" class="section level3" number="2.2.3">
<h3>
<span class="header-section-number">2.2.3</span> Now read in clips based on Raven Selection tables and calculate MFCCs<a class="anchor" aria-label="anchor" href="#now-read-in-clips-based-on-raven-selection-tables-and-calculate-mfccs"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">TrainingWavFilesDir</span> <span class="op">&lt;-</span> 
  <span class="st">"/Users/denaclink/Desktop/RStudio Projects/gibbonR/data/TrainingDataFromRavenSelectionTables/"</span>

<span class="va">trainingdata</span> <span class="op">&lt;-</span> <span class="fu">gibbonR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gibbonR/man/MFCCFunction.html">MFCCFunction</a></span><span class="op">(</span>input.dir<span class="op">=</span><span class="va">TrainingWavFilesDir</span>, min.freq <span class="op">=</span> <span class="fl">400</span>, max.freq <span class="op">=</span> <span class="fl">1600</span>,win.avg<span class="op">=</span><span class="st">"TRUE"</span><span class="op">)</span>


<span class="va">trainingdata</span><span class="op">$</span><span class="va">class</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">trainingdata</span><span class="op">$</span><span class="va">class</span><span class="op">)</span></code></pre></div>
</div>
<div id="compare-random-forest-and-support-vector-machine-for-supervised-classification-1" class="section level3" number="2.2.4">
<h3>
<span class="header-section-number">2.2.4</span> Compare Random Forest and Support Vector Machine for Supervised Classification<a class="anchor" aria-label="anchor" href="#compare-random-forest-and-support-vector-machine-for-supervised-classification-1"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">trainingdata</span><span class="op">$</span><span class="va">class</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">trainingdata</span><span class="op">$</span><span class="va">class</span><span class="op">)</span>


<span class="va">ml.model.svm</span> <span class="op">&lt;-</span> <span class="fu">e1071</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/e1071/man/svm.html">svm</a></span><span class="op">(</span><span class="va">trainingdata</span><span class="op">[</span>, <span class="fl">2</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">trainingdata</span><span class="op">)</span><span class="op">]</span>, <span class="va">trainingdata</span><span class="op">$</span><span class="va">class</span>, kernel <span class="op">=</span> <span class="st">"radial"</span>, 
                           cross <span class="op">=</span> <span class="fl">25</span>,
                           probability <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">'SVM accuracy'</span>,<span class="va">ml.model.svm</span><span class="op">$</span><span class="va">tot.accuracy</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] "SVM accuracy 98.1132075471698"</span>


<span class="va">ml.model.rf</span> <span class="op">&lt;-</span> <span class="fu">randomForest</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/randomForest/man/randomForest.html">randomForest</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">trainingdata</span><span class="op">[</span>, <span class="fl">2</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">trainingdata</span><span class="op">)</span><span class="op">]</span>, y <span class="op">=</span> <span class="va">trainingdata</span><span class="op">$</span><span class="va">class</span><span class="op">)</span>


<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">ml.model.rf</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt;  randomForest(x = trainingdata[, 2:ncol(trainingdata)], y = trainingdata$class) </span>
<span class="co">#&gt;                Type of random forest: classification</span>
<span class="co">#&gt;                      Number of trees: 500</span>
<span class="co">#&gt; No. of variables tried at each split: 13</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;         OOB estimate of  error rate: 3.77%</span>
<span class="co">#&gt; Confusion matrix:</span>
<span class="co">#&gt;               female.gibbon noise class.error</span>
<span class="co">#&gt; female.gibbon            25     1  0.03846154</span>
<span class="co">#&gt; noise                     1    26  0.03703704</span></code></pre></div>

</div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="index.html"><span class="header-section-number">1</span> Getting started</a></div>
<div class="next"><a href="part-2.-run-the-detectorclassifier.html"><span class="header-section-number">3</span> Part 2. Run the detector/classifier</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#part-1.-prepare-training-data"><span class="header-section-number">2</span> Part 1. Prepare Training Data</a></li>
<li>
<a class="nav-link" href="#part-1a.-training-data-with-labeled-.wav-clips"><span class="header-section-number">2.1</span> Part 1A. Training Data with Labeled .wav clips</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#read-in-clips-and-calculate-mfccs"><span class="header-section-number">2.1.1</span> Read in clips and calculate MFCCs</a></li>
<li><a class="nav-link" href="#compare-random-forest-and-support-vector-machine-for-supervised-classification"><span class="header-section-number">2.1.2</span> Compare Random Forest and Support Vector Machine for Supervised Classification</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#part-1b.-training-data-with-raven-selection-tables"><span class="header-section-number">2.2</span> Part 1B. Training Data with Raven Selection Tables</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#prepare-training-data-from-labeled-annotations"><span class="header-section-number">2.2.1</span> Prepare training data from labeled annotations</a></li>
<li><a class="nav-link" href="#prepare-noise-training-data-from-files-without-target-signal"><span class="header-section-number">2.2.2</span> Prepare noise training data from files without target signal</a></li>
<li><a class="nav-link" href="#now-read-in-clips-based-on-raven-selection-tables-and-calculate-mfccs"><span class="header-section-number">2.2.3</span> Now read in clips based on Raven Selection tables and calculate MFCCs</a></li>
<li><a class="nav-link" href="#compare-random-forest-and-support-vector-machine-for-supervised-classification-1"><span class="header-section-number">2.2.4</span> Compare Random Forest and Support Vector Machine for Supervised Classification</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>gibbonR: An R package for the automated detection and classification of female gibbon calls from long-term acoustic recordings</strong>" was written by Dena J. Clink. It was last built on 2022-10-15.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>
</body>
</html>
